<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Spanish Flashcards</title>

<style>
  body {
    margin: 0;
    min-height: 100vh;
    background: #0b0b0b;
    color: #f3f3f3;
    font-family: system-ui, -apple-system, Helvetica, Arial, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  .card {
    width: min(92vw, 900px);
    height: min(55vh, 460px);
    background: #141414;
    border-radius: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    cursor: pointer;
    box-shadow: 0 20px 50px rgba(0,0,0,0.45);
    padding: 32px;
    box-sizing: border-box;
    user-select: none;
    border: 1px solid rgba(255,255,255,0.10);
  }

  .word {
    font-size: clamp(2.2rem, 6vw, 5rem);
    font-weight: 750;
    line-height: 1.15;
  }

  .label {
    margin-top: 12px;
    font-size: 0.95rem;
    opacity: 0.75;
  }

  .controls {
    margin-top: 20px;
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    justify-content: center;
  }

  button {
    background: #1f1f1f;
    color: #fff;
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 14px;
    padding: 12px 18px;
    font-size: 1rem;
    font-weight: 650;
    cursor: pointer;
  }

  button:hover { opacity: 0.9; }

  .status {
    margin-top: 14px;
    font-size: 0.9rem;
    opacity: 0.8;
    text-align: center;
    max-width: min(92vw, 900px);
    line-height: 1.35;
  }

  .error {
    margin-top: 10px;
    max-width: min(92vw, 900px);
    padding: 10px 12px;
    border-radius: 12px;
    background: rgba(255,70,70,0.12);
    border: 1px solid rgba(255,70,70,0.35);
    display: none;
    white-space: pre-wrap;
    font-size: 0.95rem;
  }

  .tiny {
    margin-top: 10px;
    opacity: 0.65;
    font-size: 0.9rem;
    text-align: center;
  }
</style>
</head>

<body>

<div class="card" id="card" title="Click to flip">
  <div>
    <div class="word" id="word">Loading…</div>
    <div class="label" id="label">If stuck, check the error box below.</div>
  </div>
</div>

<div class="controls">
  <button id="prevBtn">← Prev</button>
  <button id="flipBtn">Flip</button>
  <button id="nextBtn">Next →</button>
  <button id="shuffleBtn">Shuffle</button>
  <button id="startBtn">Start: <span id="startSideLabel">EN</span></button>
  <button id="audioBtn">Audio: <span id="audioLabel">ON</span></button>
</div>

<div class="status" id="status"></div>
<div class="error" id="errorBox"></div>
<div class="tiny">Keys: Space=Flip · ←/→ navigate</div>

<script>
/* =========================
   SHOW JS ERRORS ON PAGE
   ========================= */
(function () {
  const errorBox = document.getElementById("errorBox");
  window.addEventListener("error", (e) => {
    errorBox.style.display = "block";
    errorBox.textContent = "JS ERROR:\n" + (e.message || "Unknown error");
  });
})();

/* =========================
   DECKS
   ========================= */

// 1) Conjugation endings
const CONJUGATION_CARDS = [
  { en: "-o, -as, -a, -amos, -áis, -an", es: "Present -AR" },
  { en: "-o, -es, -e, -emos, -éis, -en", es: "Present -ER" },
  { en: "-o, -es, -e, -imos, -ís, -en", es: "Present -IR" },

  { en: "-é, -aste, -ó, -amos, -asteis, -aron", es: "Preterite -AR (completed past)" },
  { en: "-í, -iste, -ió, -imos, -isteis, -ieron", es: "Preterite -ER/-IR (completed past)" },

  { en: "-aba, -abas, -aba, -ábamos, -abais, -aban", es: "Imperfect -AR (habit/background)" },
  { en: "-ía, -ías, -ía, -íamos, -íais, -ían", es: "Imperfect -ER/-IR (habit/background)" },

  { en: "infinitive + -é, -ás, -á, -emos, -éis, -án", es: "Future (all verbs)" },
  { en: "infinitive + -ía, -ías, -ía, -íamos, -íais, -ían", es: "Conditional (all verbs)" },

  { en: "-e, -es, -e, -emos, -éis, -en", es: "Present Subjunctive -AR" },
  { en: "-a, -as, -a, -amos, -áis, -an", es: "Present Subjunctive -ER/-IR" },

  { en: "-ra, -ras, -ra, -ramos, -rais, -ran", es: "Imperfect Subjunctive (-ra)" },
  { en: "-se, -ses, -se, -semos, -seis, -sen", es: "Imperfect Subjunctive (-se)" },
];

// 2) Irregular verbs (sample; add more as you like)
const IRREGULAR_VERB_CARDS = [
  { en: "ser (present)", es: "soy, eres, es, somos, sois, son" },
  { en: "ir (present)", es: "voy, vas, va, vamos, vais, van" },
  { en: "tener (present)", es: "tengo, tienes, tiene, tenemos, tenéis, tienen" },
  { en: "hacer (present)", es: "hago, haces, hace, hacemos, hacéis, hacen" },
];

// 3) Your main vocab deck (keep ONLY {en, es} objects here)
const NON_RULE_CARDS = [
  { en: "to be (essential)", es: "ser" },
  { en: "to be (temporary)", es: "estar" },
  { en: "to have", es: "tener" },
  { en: "to go", es: "ir" },
  { en: "to come", es: "venir" },
  { en: "however", es: "sin embargo" },
  { en: "therefore", es: "por lo tanto" },
  { en: "in fact", es: "de hecho" },

  // FIXED: missing comma example corrected here
  { en: "how much / many", es: "cuánto/a" },
  { en: "already", es: "ya" },

  // Add the rest of your vocab here…
];

const ALL_CARDS = [
  ...CONJUGATION_CARDS,
  ...IRREGULAR_VERB_CARDS,
  ...NON_RULE_CARDS
];

/* =========================
   APP STATE
   ========================= */
let deck = [...ALL_CARDS];
let index = 0;
let startSide = "EN";          // "EN" or "ES"
let showingSpanish = false;    // current side showing
let audioOn = true;

/* =========================
   ELEMENTS
   ========================= */
const cardEl = document.getElementById("card");
const wordEl = document.getElementById("word");
const labelEl = document.getElementById("label");
const statusEl = document.getElementById("status");
const startSideLabel = document.getElementById("startSideLabel");
const audioLabel = document.getElementById("audioLabel");

/* =========================
   AUDIO (browser dependent)
   ========================= */
function speak(text, lang) {
  if (!audioOn) return;
  if (!("speechSynthesis" in window)) return;
  try {
    window.speechSynthesis.cancel();
    const u = new SpeechSynthesisUtterance(text);
    u.lang = lang;
    u.rate = 0.95;
    window.speechSynthesis.speak(u);
  } catch {}
}

/* =========================
   SHUFFLE (Fisher–Yates)
   ========================= */
function shuffleInPlace(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
}

/* =========================
   RENDER
   ========================= */
function render() {
  if (!deck.length) {
    wordEl.textContent = "No cards";
    labelEl.textContent = "";
    statusEl.textContent = "";
    return;
  }

  const c = deck[index];
  const text = showingSpanish ? c.es : c.en;
  const lang = showingSpanish ? "es-ES" : "en-US";

  wordEl.textContent = text;
  labelEl.textContent = showingSpanish ? "Spanish" : "English";

  const audioStatus = ("speechSynthesis" in window)
    ? (audioOn ? "ON" : "OFF")
    : "Not supported";

  statusEl.textContent = `Card ${index + 1} / ${deck.length} · Start: ${startSide} · Audio: ${audioStatus}`;

  speak(text, lang);
}

/* =========================
   ACTIONS
   ========================= */
function flipCard() {
  showingSpanish = !showingSpanish;
  render();
}
function nextCard() {
  index = (index + 1) % deck.length;
  showingSpanish = (startSide === "ES");
  render();
}
function prevCard() {
  index = (index - 1 + deck.length) % deck.length;
  showingSpanish = (startSide === "ES");
  render();
}
function shuffleDeck() {
  shuffleInPlace(deck);
  index = 0;
  showingSpanish = (startSide === "ES");
  render();
}
function toggleStart() {
  startSide = (startSide === "EN") ? "ES" : "EN";
  startSideLabel.textContent = startSide;
  showingSpanish = (startSide === "ES");
  render();
}
function toggleAudio() {
  audioOn = !audioOn;
  audioLabel.textContent = audioOn ? "ON" : "OFF";
  render();
}

/* =========================
   EVENTS
   ========================= */
document.getElementById("prevBtn").addEventListener("click", prevCard);
document.getElementById("flipBtn").addEventListener("click", flipCard);
document.getElementById("nextBtn").addEventListener("click", nextCard);
document.getElementById("shuffleBtn").addEventListener("click", shuffleDeck);
document.getElementById("startBtn").addEventListener("click", toggleStart);
document.getElementById("audioBtn").addEventListener("click", toggleAudio);
cardEl.addEventListener("click", flipCard);

document.addEventListener("keydown", (e) => {
  if (e.code === "Space") { e.preventDefault(); flipCard(); }
  if (e.key === "ArrowRight") nextCard();
  if (e.key === "ArrowLeft") prevCard();
});

/* =========================
   INIT
   ========================= */
startSideLabel.textContent = startSide;
audioLabel.textContent = audioOn ? "ON" : "OFF";
showingSpanish = (startSide === "ES");
render();
</script>

</body>
</html>
